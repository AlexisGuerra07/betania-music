<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betania Music - Gestor Avanzado de Canciones</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">üéµ Betania Music</div>
            <nav>
                <div class="nav-tabs">
                    <button class="nav-tab active" data-route="canciones">Canciones</button>
                    <button class="nav-tab" data-route="edicion">Edici√≥n</button>
                    <button class="nav-tab" data-route="configuracion">Configuraci√≥n</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Songs List View -->
        <div class="view active" id="view-canciones">
            <div class="songs-container">
                <div class="section-header">
                    <h2 class="section-title">Canciones</h2>
                    <button class="btn-add-song" id="btn-add-song">‚ûï A√±adir canci√≥n</button>
                </div>

                <div class="search-container">
                    <input type="text" class="search-box" id="search-box" placeholder="Buscar por t√≠tulo o autor...">
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="empty-state">
                    <h3>A√∫n no hay canciones</h3>
                    <p>Pulsa "A√±adir canci√≥n" para crear la primera.</p>
                </div>

                <!-- Songs Grid -->
                <div class="songs-grid" id="songs-grid" style="display: none;">
                    <!-- Songs will be dynamically added here -->
                </div>
            </div>
        </div>

        <!-- Song Reader View -->
        <div class="view" id="view-song-reader">
            <div class="song-reader">
                <div class="reader-header">
                    <button class="btn" id="btn-back-to-list">‚Üê Volver a canciones</button>
                    <div class="reader-title" id="reader-title">T√≠tulo de la canci√≥n</div>
                    <div class="reader-meta" id="reader-meta">Autor ‚Ä¢ Tonalidad base</div>
                    
                    <div class="reader-controls">
                        <div class="transpose-controls">
                            <span style="font-size: 0.8rem; color: var(--gray-500);">Tonalidad:</span>
                            <button class="transpose-btn" id="btn-transpose-down-reader">‚ô≠</button>
                            <div class="current-key" id="current-key-reader">D</div>
                            <button class="transpose-btn" id="btn-transpose-up-reader">‚ôØ</button>
                            <button class="btn btn-sm" id="btn-reset-key-reader">Base</button>
                        </div>
                        
                        <select class="form-select" id="notation-reader" style="width: auto;">
                            <option value="latin">Do, Re, Mi...</option>
                            <option value="anglo">C, D, E...</option>
                        </select>
                        
                        <button class="btn btn-primary" id="btn-edit-song">Editar</button>
                    </div>
                </div>

                <div class="song-content" id="song-content">
                    <!-- Song sections will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Editor View -->
        <div class="view" id="view-edicion">
            <div class="editor-container">
                <!-- Editor Sidebar -->
                <div class="editor-sidebar">
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Estructura</h3>
                        <div id="sections-outline">
                            <!-- Outline will be generated here -->
                        </div>
                        <button class="btn btn-sm" id="btn-add-section" style="width: 100%; margin-top: 0.5rem;">+ Secci√≥n</button>
                    </div>
                    
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Acciones</h3>
                        <button class="btn btn-sm" id="btn-import-json" style="width: 100%; margin-bottom: 0.5rem;">Importar JSON</button>
                        <button class="btn btn-sm" id="btn-export-json" style="width: 100%; margin-bottom: 0.5rem;">Exportar JSON</button>
                        <button class="btn btn-sm" id="btn-transpose-up" style="width: 100%; margin-bottom: 0.25rem;">‚ôØ Subir tono</button>
                        <button class="btn btn-sm" id="btn-transpose-down" style="width: 100%; margin-bottom: 0.25rem;">‚ô≠ Bajar tono</button>
                        <button class="btn btn-sm" id="btn-reset-transpose" style="width: 100%;">Reset</button>
                    </div>
                </div>

                <!-- Editor Main -->
                <div class="editor-main">
                    <div class="editor-toolbar">
                        <div class="toolbar-left">
                            <button class="btn btn-sm" id="btn-back-from-editor">‚Üê Volver</button>
                            <input type="text" id="song-title-editor" placeholder="T√≠tulo de la canci√≥n" 
                                   style="font-size: 1.1rem; font-weight: 600; border: none; background: transparent; outline: none; min-width: 200px;">
                        </div>
                        
                        <div class="toolbar-right">
                            <div class="chips-container">
                                <div class="chip" id="auto-sections-chip">
                                    <span>Auto-secciones:</span>
                                    <span id="auto-sections-status">ON</span>
                                </div>
                                <div class="chip" id="notation-chip">
                                    <span>Notaci√≥n:</span>
                                    <span id="notation-status">Latina</span>
                                </div>
                                <div class="chip" id="key-chip">
                                    <span>Tonalidad:</span>
                                    <span id="key-status">Do</span>
                                </div>
                            </div>
                            <span class="save-indicator" id="save-indicator">Guardado</span>
                            <button class="btn btn-sm" id="btn-reanalyze" style="display: none;">üîÑ Reanalizar (auto)</button>
                            <button class="btn btn-sm" id="btn-add-pair-editor">+ Par</button>
                            <button class="btn btn-primary" id="btn-save-song">Guardar</button>
                        </div>
                    </div>

                    <!-- Editor Content -->
                    <div class="editor-content" id="editor-content">
                        <!-- Sections and pairs will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Configuration View -->
        <div class="view" id="view-configuracion">
            <div class="songs-container">
                <div class="section-header">
                    <h2 class="section-title">Configuraci√≥n</h2>
                </div>
                <div style="padding: 2rem;">
                    <h3>Preferencias</h3>
                    <div class="form-group">
                        <label class="form-label">Notaci√≥n por defecto</label>
                        <select class="form-select" id="default-notation">
                            <option value="latin">Latina (Do, Re, Mi...)</option>
                            <option value="anglo">Anglosajona (C, D, E...)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tama√±o de fuente en editor</label>
                        <select class="form-select" id="editor-font-size">
                            <option value="12">12px</option>
                            <option value="14" selected>14px</option>
                            <option value="16">16px</option>
                            <option value="18">18px</option>
                            <option value="20">20px</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <div class="toggle-container">
                            <span class="toggle-label">Detector autom√°tico de secciones</span>
                            <div class="toggle-switch active" id="auto-sections-toggle"></div>
                            <span class="toggle-label" id="auto-sections-label">ON</span>
                        </div>
                        <small style="color: var(--gray-500); font-size: 0.85rem;">
                            Cuando est√° activado, detecta autom√°ticamente estrofas, coros y otras secciones al pegar texto.
                        </small>
                    </div>

                    <h3 style="margin-top: 2rem;">Gesti√≥n de datos</h3>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <button class="btn" id="btn-export-data">Exportar canciones</button>
                        <button class="btn" id="btn-import-data">Importar canciones</button>
                        <button class="btn btn-danger" id="btn-clear-data">Limpiar todo</button>
                    </div>

                    <h3 style="margin-top: 2rem;">Atajos de Teclado</h3>
                    <div style="margin-top: 1rem; font-family: var(--mono-font); font-size: 0.9rem;">
                        <div><strong>Ctrl/Cmd + S:</strong> Guardar canci√≥n</div>
                        <div><strong>Enter:</strong> Nueva l√≠nea/par debajo (en editor)</div>
                        <div><strong>Ctrl/Cmd + D:</strong> Duplicar par actual</div>
                        <div><strong>Alt + ‚Üë/‚Üì:</strong> Mover par arriba/abajo</div>
                        <div><strong>Ctrl/Cmd + Backspace:</strong> Borrar par actual</div>
                        <div><strong>Escape:</strong> Salir del editor</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
